@{
    Layout = null;
}


<style>
    /*#Progress_Status {
        width: 50%;
        background-color: #ddd;
    }

    #myprogressBar {
        width: 1%;
        height: 35px;
        background-color: #4CAF50;
        text-align: center;
        line-height: 32px;
        color: black;
    }*/
    body {
    }

    svg {
        width: 35%;
        margin-bottom: -4%;
    }
</style>
<!-- Modal fileUpload-->
<div>

    <div class="modal fade" id="fileUploadPop" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="width: 75%">
            <div class="modal-content" style="margin-top:-5%">
                <div class="modal-header" style="background-color: #00766c">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span class="color:#FFF;" aria-hidden="true">×</span>
                    </button>
                    <h4 class="modal-title" style="color: #FFF;">Attachment</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-sm-4">


                            <div class="row pull-left" role="group">
                                <button type="button" class="btn btn-outline-success btn-file">
                                    <span>Choose&nbsp;file</span>
                                    <input class="chooseFile form-control form-control-file" type="file" name="files"  accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel,image/*,text/plain,.pdf,.docx">
                                </button>
                                <button id="btnStart" class="btn btn-outline-success">
                                    Start Camera
                                </button>
                                <button id="btnStop" class="btn btn-outline-danger">
                                    Stop Camera
                                </button>
                                


                            </div>


                            <div class="row"><br /></div>
                            <div class="row">

                                <div class="img-responsive" id="my_camera">
                                </div>
                                <div id="video_recoder">
                                </div>
                            </div>

                            <div class="row">
                                <button id="btnCapture" class="btn btn-outline-warning" onclick="take_snapshot()" style="background-color:#00766c; color: white;margin-left: 33%;">
                                    Capture Image
                                </button>
                                <div class="row" id="Prev" style="overflow-x: auto">
                                </div>

                            </div>

                            @*<div id="Progress_Status">
                                    <div id="myprogressBar"></div>
                                </div>*@


                        </div>
                        <div class="col-sm-2">
                            <svg id="animated" viewBox="0 0 90 90">
                                <circle cx="50" cy="50" r="45" fill="#FDB900" />
                                <path id="progress" fill="none" stroke-linecap="round" stroke-width="5" stroke="#fff"
                                      stroke-dasharray="251.2,0"
                                      d="M50 10
           a 40 40 0 0 1 0 80
           a 40 40 0 0 1 0 -80">
                                    <animate attributeName="stroke-dasharray" from="0,251.2" to="251.2,0" dur="5s" />
                                </path>
                                <text id="count" x="50" y="50" text-anchor="middle" dy="7" font-size="20">100%</text>
                            </svg>
                        </div>
                        <div class="col-sm-6">
                            <form autocomplete="off">
                                <div id="CaptureDiv" class="bs-example table-responsive col-sm-12" style="width: 100%">
                                    <table id="FileSelectTbl" class="table table-striped table-bordered table-hover" style="width: 100%">
                                        <thead>
                                            <tr>
                                                <th>
                                                    <label>
                                                        Content
                                                    </label>
                                                </th>
                                                <th>
                                                    <label>
                                                        File ID
                                                    </label>
                                                </th>
                                                <th>
                                                    <label>
                                                        File&nbsp;Name
                                                    </label>
                                                </th>
                                                <th>
                                                    <label>
                                                        File&nbsp;Type
                                                    </label>
                                                </th>
                                                <th class="text-center">
                                                    <label >
                                                        Remove
                                                    </label>
                                                </th>
                                                <th>
                                                    <label>
                                                        Activeflag
                                                    </label>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>


                <div class="modal-footer">

                    <div class="row pull-center">
                        <button id="btnSavechng" type="button" class="btn btn-outline-success" onclick="attachclose()" data-dismiss="modal" disabled="disabled"> Save Changes</button>
                    </div>
                </div>
                <!-- /.modal-dialog -->
            </div>
        </div>
    </div>

    <div class="modal fade in" id="popimage" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="width: 42%">
            <div class="modal-content"  style="margin-top: -12%;">

                <div class="modal-body">
                    <div class="row">
                        <iframe id="Prev1" style="margin-left: 4px; width:100%; height:507px;" src=""></iframe>

                        @*<img id="Prev1" style="display: none; margin-left: 4px; width:100%; height:582px;" src="" />*@
                    </div>
                </div>


                <div class="modal-footer">
                    <div class="row pull-center">
                        <button type="button" id="btnImageAdd" class="btn btn-outline-success" data-dismiss="modal"><i class="fa fa-plus-circle"></i>&nbsp;Add</button>
                        <button type="button" class="btn btn-outline-warning" data-dismiss="modal"><i class="fa fa-times-circle"></i>&nbsp;Cancel</button>

                    </div>
                    <!-- /.modal-content -->
                </div>
                <!-- /.modal-dialog -->
            </div>
        </div>
    </div>


    <div class="modal fade in" id="filesCIEPop" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="width: 55%">
            <div class="modal-content" style="margin-top: -12%;">

                <div class="modal-body" style="margin-top: -25%">
                    <div class="row">
                        <iframe id="pdfupload" style="margin-left: 4px; width:100%; height:507px;" src=""></iframe>
                    </div>
                </div>


                <div class="modal-footer">
                    <div class="row pull-center">
                        <button type="button" id="btnpopupcloseRecord" class="btn btn-outline-success" data-dismiss="modal"><i class="fa fa-times-circle"></i>&nbsp;Close</button>


                    </div>
                    <!-- /.modal-content -->
                </div>

                <!-- /.modal-dialog -->
            </div>
        </div>
    </div>


    <div id="front-page" class="row box box-primary">

        <div class="row">
            <div class="col-sm-6 pull-right-container">

                <div class="btn-group " role="group" style="background-color: #EFDADA;">
                    <button type="button" id="btnAddNew" class="btnAddNew btn btn-sm btn-outline-success" style="z-index: 9;background-color: #00766c;">
                        <i class="fa fa-plus" aria-hidden="true" style="    color: white;
    background-color: transparent;"></i>
                    </button>
                </div>

            </div>
        </div>
        <form autocomplete="off">
        <div class="panel-body">
            <div id="da" class="bs-example table-responsive">
                <table id="myDataTable" class="table table-bordered table-hover dataTable">
                    <thead style="text-transform: uppercase">
                        <tr>
                            <th>
                                Issue&nbsp;Ref.&nbsp;No
                            </th>
                            <th>
                                Issue ID
                            </th>
                            <th>
                                Date
                            </th>
                            <th>
                                Client&nbsp;Name
                            </th>
                            <th>
                                Product&nbsp;Name
                            </th>
                            <th>
                                Module&nbsp;Name
                            </th>
                            <th>
                                Form&nbsp;Name
                            </th>
                            <th>
                                Description
                            </th>
                            <th>
                                Issue&nbsp;Type
                            </th>
                            <th>
                                Status
                            </th>
                            <th class="text-center">
                                Remove
                            </th>
                            <th>
                                Issue Raised
                            </th>

                            <th>
                                Module ID
                            </th>
                            <th>
                                form ID
                            </th>
                            <th>
                                Product id
                            </th>
                            <th>
                                IssueType id
                            </th>
                            <th>
                                productid
                            </th>

                            <th>
                                file count
                            </th>


                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>

            </div>
        </div>
            </form>
    </div>
    <div id="inner-page" class="row box box-primary">

        <div class="row">
            <div class="col-sm-3">
                <div class="row">

                    <label>
                        Client&nbsp;Name
                    </label>

                    <input type="text" id="IssueClientName" class="form-control form-control-sm" disabled />
                    <input type="hidden" id="IssueClientId" class="form-control form-control-sm" />

                </div>
                <div class="row">
                    <label>
                        Product Name
                    </label>


                    <select class="form-control form-control-sm" id="txtproductname">
                        <option value="0">-- Select --</option>
                    </select>


                </div>
                <div class="row">
                    <label>
                        Module&nbsp;Name
                    </label>


                    <select class="form-control form-control-sm" id="modulename">
                        <option value="0">-- Select --</option>
                    </select>


                </div>
            </div>





            <div class="col-sm-3">
                <div class="row">
                    <label>
                        Form&nbsp;Name
                    </label>


                    <select class="form-control form-control-sm" id="formname">
                        <option value="0">-- Select --</option>
                    </select>

                </div>
                <div class="row">
                    <label>
                        Issue&nbsp;Type
                    </label>

                    @Html.DropDownList("IssueType", (IEnumerable<SelectListItem>)ViewBag.IssuseTypee, "-- Select --", new { @class = "IssueType form-control form-control-sm", id = "IssueType11" })


                </div>
                <div class="row">
                    <label>
                        Date
                    </label>

                    <input type="text" id="cdate" autocomplete="off" value="@DateTime.Now.ToString("dd/MM/yyyy")" class="form-control form-control-sm" />
                </div>
            </div>
            <div class="col-sm-6">
                <div class="row">
                    <label>
                        Description
                    </label>

                    <textarea rows="7" cols="6" id="description" style="height: 178px" class="form-control"></textarea>

                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                <div id="commentbox" class="box box-success direct-chat direct-chat-success">
                    <!-- DIRECT CHAT SUCCESS -->
                    <div>
                        <div class="box-header with-border">
                            <h3 class="box-title">Comments</h3>
                            <div class="box-tools pull-right">

                                <span data-toggle="tooltip" title="" class="total-comment badge badge-secondary" data-original-title="Messages"></span>
                                <button type="button" class="btn btn-box-tool" data-toggle="collapse" data-target="#demo">
                                    <i class="fa fa-minus"></i>
                                </button>

                            </div>

                        </div>
                        <!-- /.box-header -->
                        <div id="demo" class="collapse in">

                            <div class="list-comments">

                            </div>
                            <!-- /.box-body -->
                            <div class="box-footer">

                                <div class="input-group">
                                    <div input type="text" name="message" placeholder="Type Message ..." id="text" class="form-control" contenteditable>

                                    </div>

                                    <span class="input-group-btn">

                                        <button type="submit" class="btn btn-success btn-flat" id="Savecmt"><i class="fa fa-plus" aria-hidden="true" style="    color: white;
    background-color: transparent;"></i></button>
                                    </span>
                                </div>

                            </div>
                        </div>
                        <!-- /.box-footer-->
                    </div>
                    <!--/.direct-chat -->
                </div>

                <br />
                <!--hidden fields-->
                <input type="hidden" id="ComplaintNo" />
            </div>
            <div class="col-sm-6">
                <div style="float:right">
                    <button class="btn btn-success" id="btnAttachFile">
                        <i class="fa fa-paperclip" aria-hidden="true"></i> Attachment &nbsp;
                        <span class="count badge badge-secondary"></span>
                    </button>
                    <button class="btn btn-primary" id="btnAdd" onclick="Btnadd1()" @*onclick="AddCreate(1)"*@><i class="fas fa-pencil-alt"></i> Add</button>
                    <button class="btn btn-primary" id="btnUpdate" onclick="AddCreate(0)"><i class="fas fa-pencil-alt"></i> Update</button>
                    <button class="btn btn-danger" id="AddClear"><i class="fa fa-times-circle"></i> Clear</button>
                    <button class="btn btn-danger" onclick="Cancelclk()" id="AddCancel"><i class="fa fa-times-circle"></i> Cancel</button>


                </div>
            </div>
        </div>

        <div class="row"><br /></div>
        <div class="row">
            <div id="subtable" class="col-sm-12 bs-example table-responsive">
                <table id="tbl" class="tbl table table-bordered table-hover dataTable" style="width:100%">
                    <thead style="text-transform:uppercase">
                        <tr>
                            <th>

                                Product&nbsp;Name
                            </th>
                            <th>

                                Module&nbsp;Name
                            </th>
                            <th>

                                Form&nbsp;Name
                            </th>

                            <th>

                                Issue&nbsp;Type
                            </th>
                            <th>

                                Issue Date
                            </th>
                            <th>
                                Description
                            </th>
                            <th class="text-center">Remove</th>


                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>


        </div>


    </div>
    <div id="savetag" class="row">
        <div class="col-sm-12">

            <div style="float:right">
                @*<button class="btn btn-success" id="btnSave"><i class="fa fa-save" aria-hidden="true"></i> Ok</button>*@
                <button class="btn btn-success"  id="btnCancel"><i class="fa fa-save"></i> Save</button>
                <button class="btn btn-danger" onclick="Cancelclk1()" id="AddCancel1"><i class="fa fa-times-circle"></i> Cancel</button>

            </div>
        </div>
        <!--hidden fields-->
        <input type="hidden" id="issueId" />
        <input type="hidden" value="1" id="changeUpCFlag" />
        <input type="hidden" value="1" id="changeFileViewFlag" />
        <input type="hidden" value="1" id="changeUpdateFlag" />

    </div>

</div>

<script src="~/Contents/webcamjs-master/webcam.min.js"></script>


<script type="text/javascript">
    debugger;
    var Clientidname = '@ViewData["ClientNameId"]';
    var spl = Clientidname.split("-");
    var Name = spl[1];
    var ClientId = spl[0]
    $("#IssueClientName").val(Name);
    $("#IssueClientId").val(ClientId);
    $('#front-page').show();
    $("#inner-page").hide();
    $("#savetag").hide();



    $('#btnAddNew').click(function () {
        debugger

        $('#btnAddNew').hide();
        $('#front-page').hide();
        $("#inner-page").show();
        $("#savetag").show();
        $("#btnUpdate").hide();
        $("#AddClear").show();
        $("btnCancel").hide();
        $("#AddCancel").hide();

        $("#commentbox").hide();

        var ProductID = 0;
        Getproduct(ProductID);
    });



    function attachclose() {
        $("#my_camera").css('height', 0);
        $(".snapImage").css('display', 'none');


        var oTable123 = $('#FileSelectTbl').dataTable().fnGetData();
        Filecount = oTable123.length;
        $(".count").text("");
        $(".count").text(Filecount);
        Webcam.reset();
        Webcam.off();
        
    }

    $("#cdate").datepicker({
        autoclose: true,
        format: 'dd/mm/yyyy',
        todayHighlight: true
    }).datepicker('update', new Date());
    //$("#cdate").datepicker({
    //    format: 'dd/mm/yyyy',
    //    selectMonths: true,
    //    selectYears: true,
    //    max: true
    //});

    var deviceCheck = MobileAndTabletcheck();

    if (deviceCheck) { $(".btnSnap").show(); } else { $(".btnSnap").hide(); }

    function MobileAndTabletcheck() {
        var check = false;
        (function (a) { if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) check = true })(navigator.userAgent || navigator.vendor || window.opera);
        return check;
    }



    $('#txtproductname').change(function () {
        var ProductID = $("#txtproductname option:selected").val();
        var ClientNameID = $("#IssueClientId").val();
        var ModuleID = 0;
        Getmodulelist(ProductID, ClientNameID, ModuleID);
    });


    function Getmodulelist(ProductID, ClientNameID, ModuleID) {
        
        var Product = ProductID;
        var ClientID = ClientNameID;
        $.ajax({
            url: "../IssueRaise/GetHeaderType1",
            type: 'POST',
            data: { Branchcode: Product, ClientId: ClientID },

            success: function (data) {

                var series3 = { AssignedID: "", ModuleName: "" };
                var series = [];
                $("#modulename").empty();

                $("#modulename").append("<option value='0'>-- Select --</option>");

                $.each(data, function (ui, item) {
                    
                    series3.AssignedID = item.AssignedID;
                    series3.ModuleName = item.ModuleName;
                    $("#modulename").append("<option value=" + series3.AssignedID + ">" + series3.ModuleName + "</select>");
                });
                $("#modulename").val(ModuleID);
            }
        });

    }

    $("#modulename").change(function () {
        var ModuleID = $("#modulename option:selected").val();
        var ProductID = $("#txtproductname option:selected").val();
        var ClientNameID = $("#IssueClientId").val();
        var FormID = 0;
        GetFormList(ModuleID, ProductID, ClientNameID, FormID);
    });


    function GetFormList(ModuleID, ProductID, ClientNameID, FormID) {

        var moduleid = ModuleID;
        var Productid = ProductID;
        var ClientID = ClientNameID;
        $.ajax({
            url: "../IssueRaise/GetHeaderType12",
            type: 'POST',
            data: { Branchcode: moduleid, Productid: Productid, ClientId: ClientID },

            success: function (data) {

                var series3 = { AssignedID: "", ModuleName: "" };
                var series = [];
                $("#formname").empty();

                $("#formname").append("<option value='0'>-- Select --</option>");

                $.each(data, function (ui, item) {
                    
                    series3.AssignedID = item.AssignedID;
                    series3.ModuleName = item.ModuleName;
                    $("#formname").append("<option value=" + series3.AssignedID + ">" + series3.ModuleName + "</select>");
                });
                $("#formname").val(FormID);
            }
        });
    }


    function Getproduct(ProductID) {
        
        var BranchID = $("#IssueClientId").val();


        $.ajax({
            url: "../IssueRaise/product",
            type: 'POST',
            data: { Branchcode: BranchID },

            success: function (data) {

                var series3 = { AssignedID: "", ModuleName: "" };
                var series = [];
                $("#txtproductname").empty();

                $("#txtproductname").append("<option value='0'>-- Select --</option>");

                $.each(data, function (ui, item) {
                    series3.AssignedID = item.AssignedID;
                    series3.ModuleName = item.ModuleName;
                    $("#txtproductname").append("<option value=" + series3.AssignedID + ">" + series3.ModuleName + "</select>");
                });
                $("#txtproductname").val(ProductID);
            }

        });


    }




    $('#btnAttachFile').click(function () {
        $("#btnStart").show();
        $("#btnStop").hide();
        $("#btnCapture").hide();
        $("#fileUploadPop").modal('show');
    $("#Progress_Status").hide();
    $("#animated").hide();

    });


    function DateFormatUI(dt) {
        var data = dt;
        var r = /\/Date\(([0-9]+)\)\//gi
        var matches = data.match(r);
        var result = matches.toString().substring(6, 19);
        var epochMilliseconds = result.replace(/^\/Date\(([0-9]+)([+-][0-9]{4})?\)\/$/, '$1');
        var b = new Date(parseInt(epochMilliseconds));
        var c = new Date(b.toString());
        var curr_date = c.getDate();
        var curr_month = c.getMonth() + 1;
        var curr_year = c.getFullYear();
        var formatdate = curr_date + '/' + curr_month.toString() + '/' + curr_year;
        return formatdate;
    }

    var FileSelectTbl = $('#FileSelectTbl').dataTable({

        "bFilter": false,
        "bDestroy": true,
        "sDom": "Rfrt",
        "aoColumns": [
            { "sName": "", "bVisible": false },
            { "sName": "", "bVisible": false },
            { "sName": "" },
            { "sName": "", "bVisible": false  },
            { "sName": "activeflag", "sClass": "center", "bVisible": true },
            { "sName": "activeflag", "sClass": "center", "bVisible": false }
        ]
    });



    function GetModuleDDL(moduleId) {

        var clientid = $("#IssueClientId").val();

        $.ajax({

            url: '../IssueRaise/Bindtodropdown',
            dataType: "json",
            data: { id: clientid },
            success: function (data) {

                var select = $(".ModuleName");
                select.empty();
                select.append($('<option />', { value: "", text: "-- Select --" }));
                $.each(data, function (index, itemData) {

                    select.append($('<option />', {
                        value: itemData.Value,
                        text: itemData.Text

                    }));

                });
                $(".ModuleName").val(moduleId);

            }

        });

    }


    function update() {
  var element = document.getElementById("myprogressBar");

  var width = 1;
  var identity = setInterval(scene, 10);
  function scene() {
    if (width >= 100) {
      clearInterval(identity);
    document.getElementById("myprogressBar").innerHTML = "uploaded Successfully!";
    } else {
      width++;
      element.style.width = width + '%';
      element.innerHTML = width * 1 + '%';
    }
  }
    }

    $("input[type=file]").change(function (e) {

        var files = e.target.files;
        var k = 0;
        var files = e.target.files;
        for (var i = 0, len = files.length; i < len; i++) {

            var n = files[i].name,
                s = files[i].size,
                t = files[i].type;
            k = k + s;
        }

        if (k > 1.5e+7) {

            bootbox.alert({size:"small",message:'Please upload  lesser than the 15MB. Sorry!'});

            $("input[type=file]").val('');
        }


        else {
            $("#FileSelectTbl").dataTable()


            var oTable123 = $('#FileSelectTbl').dataTable().fnGetData();

                if (window.FormData !== undefined) {

                    for (var i = 0; i < files.length; i++) {
                        
                        var reader = new FileReader();
                        reader.onloadend = (function (file) {
                            return function (evt) {
                                var sas = (evt.target.result).toString();
                                var subStr = sas.match(":(.*);");
                                var d = new Date();
                                var month = d.getMonth() + 1;
                                var day = d.getDate();
                                var currentdate = new Date();
       var count = $(('#count'));
$({ Counter: 0 }).animate({ Counter: count.text() }, {

  duration: 5000,
  easing: 'linear',
  step: function () {
    
    count.text(Math.ceil(this.Counter)+ "%");
  }
});

var s = Snap('#animated');
var progress = s.select('#progress');

progress.attr({strokeDasharray: '0, 251.2'});
Snap.animate(0,251.2, function( value ) {
    progress.attr({ 'stroke-dasharray':value+',251.2'});
}, 5000);

                                $("#FileSelectTbl").dataTable().fnAddData([evt.target.result, 0, file.name, subStr[1], '<center><i class="fa fa-times-circle icon-cSize iconFileDelete"></i></center>', 0]);


    //$("#animated").fadeOut("slow");
    $("#animated").show(5000);
    //$("#animated").hide();
                                
                            };
                        })(files[i]);
                        reader.readAsDataURL(files[i]);


                    }
                    
            }
            $("input[type=file]").val('');

        }
        $("#btnSavechng").attr("disabled", false)
    });

    function AddCreate(Issave) {
    debugger
        var dd1 = $("#cdate").val();
        var splitdd1 = dd1.split('/');
        var FRDate = splitdd1[2] + '/' + splitdd1[1] + '/' + splitdd1[0];
        var Approvalflag = 1;
        var clientname =  $("#IssueClientName").val()
        var productname = $("#txtproductname option:selected").text();
        var modulename = $("#modulename option:selected").text();
        var formname = $("#formname option:selected").text();
        var issuetype = $("#IssueType11 option:selected").text();
        var issuedate = $("#cdate").val();
        var description = $("#description").val();



        if (clientname == "" || clientname == 0) {
            bootbox.alert({size:"small",message:"Client Name May Not Be Empty"});
            return false;
        }

        else {


            var e1 = {
                "IsSave": "", "IssueID": "", "ClientName": "", "ClientNameID": "", "ProductID": "", "ProductName": "", "ModuleID": "", "ModuleName": "",
                "FormID": "", "FormName": "", "IssueTypeID": "", "IssueType": "", "Description": "", "IssueDate": "", "CreatedBy": "", "AssignedID": "",
                "ClientID": ""

            };
            e1.IsSave = Issave;
            e1.IssueID = $("#issueId").val() == "" ? 0 : $("#issueId").val();
            e1.ClientName = $("#IssueClientName").val();
            e1.ClientNameID = $("#IssueClientId").val();
            e1.ProductID = $("#txtproductname option:selected").val() == "" ? 0 : $("#txtproductname option:selected").val();
            e1.ProductName = $("#txtproductname option:selected").text() == "" ? "" : $("#txtproductname option:selected").text();
            e1.ModuleID = $("#modulename option:selected").val() == "" ? 0 : $("#modulename option:selected").val();
            e1.ModuleName = $("#modulename option:selected").val() == "" ? "" : $("#modulename option:selected").text();
            e1.FormID = $("#formname option:selected").val() == "" ? 0 : $("#formname option:selected").val();
            e1.FormName = $("#formname option:selected").text() == "" ? "" : $("#formname option:selected").text();
            e1.IssueTypeID = $("#IssueType11 option:selected").val() == "" ? 0 : $("#IssueType11 option:selected").val();
            e1.IssueType = $("#IssueType11 option:selected").val() == "" ? "" : $("#IssueType11 option:selected").text();
            e1.Description = $("#description").val() == "" ? "" : $("#description ").val();
            e1.IssueDate = FRDate;
            e1.CreatedBy = '@Session["UserId"]';
            e1.AssignedID = Approvalflag;
            e1.ClientID = '@Session["ClientID"]';


            var objFile1 = [];
            var ATable = $('#FileSelectTbl').dataTable().fnGetData();
            var objFile = { "FileName": "", "FileContent": "", "IssueID": "", "FileId": "", "FileType": "", "IsSave": "", "CreatedBy": "", "ClientID": "" };

            for (var i = 0; i < ATable.length; i++) {
                debugger;

                objFile.FileContent = ATable[i][0];
                objFile.FileId = ATable[i][1];
                objFile.FileName = ATable[i][2];
                objFile.FileType = ATable[i][3];
                objFile.ClientID = '@Session["ClientID"]';
                objFile.CreatedBy = '@Session["UserId"]';
                var activeflag = ATable[i][5];
                if (activeflag == 0) {
  debugger   
                    objFile.IsSave = 1;
                }
                else {

                    objFile.IsSave = 0;
                }

                objFile1.push(objFile);

                objFile = { "FileName": "", "FileContent": "", "IssueID": "", "FileId": "", "FileType": "", "IsSave": "", "CreatedBy": "", "ClientID": "" };

            }


            $.ajax({
                url: "../IssueRaise/CreateIssue",
                data: JSON.stringify({ IssueDetails: e1, Fileupload: objFile1, DelListobj: Filedlt}),
                type: 'POST',
                contentType: 'application/json;',
                dataType: 'json',
                success: function (result) {
                    if (result.Success == 1 && Issave == 1) {

                        $('#FileSelectTbl').dataTable().fnClearTable();
                        //$('.tbl').dataTable().fnAddData([modulename, formname, productname, issuetype, issuedate, description,'<center><i class="fa fa-times-circle icon-cSize iconcliDelete"></i></center>']);
                       
                    }
                    else if (result.Success == 1 && Issave == 0) {
                        $('#btnUpdate').attr("disabled", true);
                        bootbox.alert({ size: "small", message:"Updated Successfully"});
                        Cancelclk();
                    }
                    else {
                        bootbox.alert({size:"small",message:"Record Not Saved"});
                    }
                }
            });
        }
    }

    function clear() {
        $("#description").val("");
        var oTable123 = $('#FileSelectTbl').dataTable().fnGetData();
        Filecount = oTable123.length;
        $(".count").text("");
        $(".count").text(Filecount);

    }

    var Maintable = $('#myDataTable').dataTable();
    $("#myDataTable tbody").delegate("tr", "dblclick", function () {
        debugger
        var ipos = Maintable.fnGetPosition(this);
        if (ipos != null) {
            aData = Maintable.fnGetData(ipos);
            Getproduct(aData[14]);
            Getmodulelist(aData[14], aData[16], aData[12]);
            GetFormList(aData[12], aData[14], aData[16], aData[13]);
            $('#header').css("display", "none");
            $('#btnAddNew').hide();
            $('#btnAdd').hide();
            $('#front-page').hide();
            $("#inner-page").show();
            $("#btnSave").hide();
            $("#btnUpdate").show();
            $("#AddClear").hide();
            $("#AddCancel").show();
            $("btnCancel").show();
            $("#subtable").hide();
            $("#commentbox").show();


            CompltIssueNo = aData[0];
            IssueID = aData[1];
            CompanyName = aData[3];
            ModuleName = aData[5];
            FormName = aData[6];
            ProductName = aData[4];
            IssueType = aData[8];
            IssueDate = aData[2];
            CreatedDate = aData[11];
            Description = aData[7];
            ModuleID = aData[12];
            FormID = aData[13];
            ProductID = aData[14];
            IssueTypeID = aData[15]
            ClientNameID = aData[16];
            Filecount = aData[17];
            ShortNmae = aData[9];
            debugger
            $("#IssueClientId").val(ClientNameID);
            $("#IssueClientName").val(CompanyName);
            $("#modulename").val(ModuleID);
            $("#formname").val(FormID);
            $("#issueId").val(IssueID);
            $("#IssueType11").val(IssueTypeID);
            $("#description").val(Description);
            $("#cdate").val(IssueDate);
            if (ShortNmae == "In Progress") {
                $('#btnUpdate').show();
            }
            else if (ShortNmae == "Rejected") {
                $('#btnUpdate').hide();
            }
            else {
                $('#btnUpdate').hide();

            }

            $(".count").text(Filecount);


            var issueDetailId = $("#issueId").val();
            $.ajax({
                url: "../IssueRaise/GetAllFileById",
                type: 'POST',
                data: { IssueDetailID: issueDetailId },
                dataType: 'json',
                success: function (result) {
                    debugger
                    $.each(result, function (i, item) {

                        $('#FileSelectTbl').dataTable().fnAddData(['', item.FileId, item.FileName, item.FileType, '<center><i class="fa fa-times-circle icon-cSize iconFileDelete" onclick="GetFileById(+item.FileId+)"></i><center>', 1]);
                    });


                }
            });



            var htmla = "";
            $listComment = $(".list-comments");
            $(".list-comments").empty();
            $.ajax({
                url: "../IssueApproval/GetComments",
                dataType: 'json',
                data: { IssueDetailID: issueDetailId },
                type: 'POST',
                success: function (result) {
                    $(".list-comments").empty();
                    $totalCom = $(".total-comment");
                    $totalCom.text(result.length);
                    $.each(result, function (i, item) {
                        htmla += '<div class="row"><div class="col-sm-6"><label>' + item.UserName + ' : ' + item.Comments + '</label></div>';
                        htmla += '<div class="col-sm-6"></div><div class="col-sm-6"><label>' + item.CommentsDate + '</label></div><div class="col-sm-6"></div></div>';
                    });
                    $listComment.append(htmla);
                }


            });

        }


    });


    function GetFileById(t) {

        var id = t.id;
        var $this = $(t);
        $this.closest('.list-group').find('.active').removeClass('active');
        $this.addClass('active');

        var idSplit = id.split('|');
        var fileId = idSplit[0];
        var type = idSplit[1];
        var typeSplit = type.split('/');
        var imgType = typeSplit[0];
        var fileUrl = "";
        var downfileUrl = "";

        if (type == "application/pdf") {

            $("#filePreview").empty();
            fileUrl = "../IssueRaise/GetFile?id=" + fileId;
            downfileUrl = "../IssueRaise/DownloadFile?id=" + fileId;


            var aPdf = '<label><i class="fa fa-trash"></i><a id=' + id + ' href="#" onClick="DeleteFile(this);">Delete</a>&nbsp;|&nbsp;<i class="fa fa-download "></i><a href=' + downfileUrl + '>Download&nbsp;/&nbsp;' + idSplit[2] + '</i ></label > ';
            var bPdf = '<iframe style="width:100%;height:50vh;" src=' + fileUrl + ' type="application/pdf"></iframe><br /><br />' + aPdf;
            $("#filePreview").append(bPdf);

        } else if (imgType == "image") {

            $("#filePreview").empty();
            fileUrl = "../IssueRaise/GetFile?id=" + fileId;
            downfileUrl = "../ClientIssueRaise/DownloadFile?id=" + fileId;

            var aImage = '<label><i class="fa fa-trash"></i><a id=' + id + ' href="#" onClick="DeleteFile(this);">Delete</a>&nbsp;|&nbsp;<i class="fa fa-download"></i><a href=' + downfileUrl + '>Download&nbsp;/&nbsp;' + idSplit[2] + '</i ></label > ';
            var bImage = '<img style="width:100%;height:60vh;" src=' + fileUrl + '></img><br /><br />' + aImage;
            $("#filePreview").append(bImage);

        } else {

            $("#filePreview").empty();
            fileUrl = "../IssueRaise/DownloadFile?id=" + fileId;
            deletefileUrl = "../IssueRaise/DeleteFile?id=" + fileId;
            var aa = '<center style="margin-top:10vh;"><h3>No preview available !</h3><br /><label><i class="fa fa-trash"></i><a id=' + id + ' href="#" onClick="DeleteFile(this);">Delete</a>&nbsp;|&nbsp;<i class="fa fa-download"></i><a href=' + fileUrl + '>Download&nbsp;/&nbsp;' + idSplit[2] + '</i></label></center>';
            $("#filePreview").append(aa);

        }


    }






    var mainTBL = $('#myDataTable').dataTable({
        "bPaginate": true,
        "bLengthChange": false,
        "bFilter": true,
        "bSort": false,
        "bInfo": true,
        "bAutoWidth": false,
        "bDestroy": true,
        "bServerSide": true,
        "iDisplayLength": 15,
        "sAjaxSource": "../IssueRaise/AjaxHandler",
        "bProcessing": true,
        "aoColumns": [

            { "sName": "CompltIssueNo", "bVisible": true },//0
            { "sName": "issueid", "bVisible": false },//1
            { "sName": "IssueDate1", "bVisible": true },//7
            { "sName": "CompanyName", "bVisible": false },//2
            { "sName": "ModuleName" },//3
            { "sName": "FormName" },//4
            { "sName": "Featurename" },//5
            { "sName": "IssueType" },//6
           
            { "sName": "Status" },//8
            { "sName": "Status" },//8
            { "sName": "", "bVisible": true },//9
            { "sName": "DepartmentName", "bVisible": false },//10
            { "sName": "IssueID", "bVisible": false },//11
            { "sName": "ClientID", "bVisible": false },//12
            { "sName": "ModuleID", "bVisible": false },//13
            { "sName": "FormID", "bVisible": false },//14
            { "sName": "", "bVisible": false },//15
            { "sName": "", "bVisible": false },//16
            


        ]

    });

    $('#tbl').dataTable({

        //"bPaginate": true,
        "bLengthChange": false,
        "bFilter": false,
        "bSort": false,
        "bInfo": true,
        "bAutoWidth": false,
        "bDestroy": true,
        "iDisplayLength": 5,
        //"bServerSide": true,

        "aoColumns": [
            { "sName": "", "bVisible": true },  //1
            { "sName": "", "bVisible": true },   //2
            { "sName": "", "bVisible": true },  //3
            { "sName": "", "bVisible": true }, //4
            { "sName": "", "bVisible": true }, // 5
            { "sName": "", "bVisible": true }, //6
            { "sName": "", "bVisible": true }, //6


        ]

    });



    $("#FileSelectTbl tbody").delegate("tr", "dblclick", function () {
        var main123 = $('#FileSelectTbl').dataTable();
        var ipos = main123.fnGetPosition(this);
        if (ipos != null) {
            var adata = main123.fnGetData(ipos);
            var file = adata[0];
            var fileid = adata[1];

            doSomething(fileid, file);
        }
    });

    function doSomething(fileid, file) {
            var src1 = "";
            $('#pdfupload').attr('src', src1);
            $('#filesCIEPop').modal('show');
            $("#btnpopupcloseRecord").modal('show');
            $("#fileUploadPop").modal('hide');
            $('#pdfupload').css("display", "block");
        if (fileid == 0) {
     debugger
            $('#pdfupload').attr('src', file);
            }
            else {
   
                var s = fileid;
                var src1 = '@Url.Action("GetFile", "ClientIssueRaise", new { id = "-1" })';
                src1 = src1.replace("-1", s);
            $('#pdfupload').attr('src', src1);
            $("#download").val(fileid);
        }


    }


    $("#download").click(function () {
        downfileUrl = "../IssueRaise/DownloadFile?id=" + fileId;
    });




    $("#btnpopupcloseRecord").click(function () {

        $("#fileUploadPop").modal('show');
        $('#filesCIEPop').modal('hide');
    });


    //Take a snapshot
    var chooseImage = "";
    var imageSrc = "";
    var imgid = 0;
    var chooseImage1 = "";

    $("#btnStart").click(function () {
        $(this).hide();
        $("#btnStop").show();
        $("#btnCapture").show();
        ShowCam();

    });
    function ShowCam() {

        Webcam.set({
            width: 500,
            height: 336,
            dest_width: 640,
            dest_height: 480,
            image_format: 'jpeg',
            jpeg_quality: 100,
            force_flash: false
        });
        Webcam.attach('#my_camera');
        Webcam.init(
            navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia);
        webcam.attach(navigator.getUserMedia({ video: true }, handleVideo, videoError)
            , function handleVideo(stream) {
                video.src = window.URL.createObjectURL(stream);
            });

    }



    $("#btnStop").click(function () {
        $("#btnStart").show();
        $("#btnStop").hide();
        $("#btnCapture").hide();
        $(".snapImage").attr("display", "none");
        $("#my_camera").css("height", 0);
        Webcam.reset();
        Webcam.off();

    });


    function take_snapshot() {
        Webcam.snap(function (data_uri) {

            Webcam.snap(function (data_uri) {
                imageSrc = data_uri;
                chooseImage = '<img src="' + data_uri + '" id="snapImage' + imgid + '" class="snapImage pull-left img-responsive img-thumbnail" style="width:20%;"onClick="SelectImage(this,this.id);" alt="Responsive image"></img>';

                $('#Prev').append(chooseImage);
                imgid++;
            });

        });
    }



    function SelectImage(x, y) {
        //$('#btnImageAdd').css("display", "block");
        //$('#btnImageUpdate').css("display", "none");

        $('.snapImage').css({
            "border-color": "transparent",
            "border-width": "1px",
            "border-style": "solid"
        });
        $('#' + y + '').css({
            "border-color": "rgb(48, 118, 226)",
            "border-width": "1px",
            "border-style": "solid"
        });
        imageSrc = $(x).attr('src');
        var img = $('<img />', {
            src: this.src,
            'class': 'fullImage'
        });
        $('#Prev1').attr('src', imageSrc);
        $("#popimage").modal('show');
        chooseImage = '<img src="' + imageSrc + '" class="snapImage pull-left img-responsive img-thumbnail" style="width: 100%; height: 524px;" onClick="SelectImage(this);" alt="Responsive image"></img>';

    }

    var e = 0;
    $('#btnImageAdd').click(function () {

        var d = 1;
         d += e;

        $('#Prev1').attr('src', imageSrc);
        chooseImage = '<img src="' + imageSrc + '" class="snapImage pull-left img-responsive img-thumbnail" style="width: 100%; height: 524px;" onClick="SelectImage(this);" alt="Responsive image"></img>';
        var name = "Photo" + d;
        var type = "image/jpeg";
        e = d++;
          var count = $(('#count'));
$({ Counter: 0 }).animate({ Counter: count.text() }, {

  duration: 5000,
  easing: 'linear',
  step: function () {
    count.text(Math.ceil(this.Counter)+ "%");
  }
});

var s = Snap('#animated');
var progress = s.select('#progress');

progress.attr({strokeDasharray: '0, 251.2'});
Snap.animate(0,251.2, function( value ) {
    progress.attr({ 'stroke-dasharray':value+',251.2'});
        }, 5000);
        
        $("#FileSelectTbl").dataTable().fnAddData([imageSrc, '', name, type, '<center><i class="fa fa-times-circle icon-cSize iconFileDelete"></i></center>', 0]);
        $("#animated").show(5000);

        
    });

    //snapshotend


    $("#myDataTable tbody").delegate("i.delete", "click", function () {
        
        var iPos = $(this).closest('tr').index();
        var Maintable = $('#myDataTable').dataTable();
        if (iPos != null) {
        bootbox.confirm({size:"small",message:"Are you sure you want to delete it?",callback: function (result) {
            if (result) {
                    var aData = Maintable.fnGetData(iPos);
                objdlt = { "IssueID": "", "ClientID": "", "UserID": "" };
                objdlt.IssueID = aData[1];
                objdlt.ClientID = '@Session["ClientID"]';
                objdlt.UserID = '@Session["UserId"]';
                $.ajax({
                    url: "../IssueRaise/DeleteIssueRaiseById",
                    data: JSON.stringify({ Dltproperty: objdlt }),
                    type: 'POST',
                    contentType: 'application/json;',
                    dataType: 'json',

                        success: function (result) {
                            if (result.success == 0) {
                                bootbox.alert({size:"small",message:"Deleted"});
                                Maintable.fnDeleteRow(iPos);
                                $('#myDataTable').dataTable().fnDraw();


                            }
                        }
                    });
    }
                }
            });
        }
    });


    $('#Savecmt').click(function () {
          debugger
            var $text = $("#text"),
                $submit = $("input[type='submit']"),
                $listComment = $(".list-comments"),
                $loading = $(".loading"),
                _data,
                $totalCom = $(".total-comment");
            $totalCom.text($(".list-comments > div").length);
            if ($text.html() == "") {
                alert("Please write a comment!");
                $text.focus();
            } else {
                debugger
                var objissueDtl = { "Type": "", "CommentsID": "", "UserName": "", "Comments": "", "CreatedBy": "", "IssueDetailID": "","Clientid":""}
                objissueDtl.Clientid = '@Session["CilentID"]';
                objissueDtl.Comments = $text.html();
                objissueDtl.CommentsID = 0;
                objissueDtl.CreatedBy ='@Session["UserID"]';
                objissueDtl.IssueDetailID = $("#issueId").val();
                objissueDtl.Type = 1;
                objissueDtl.UserName='@Session["UserName"]';
                $.ajax({
                    url: '../IssueApproval/CreateComments',
                    data: JSON.stringify({ objissueDtl: objissueDtl }),
                    type: 'POST',
                    contentType: 'application/json;',
                    dataType: 'json',
                    success: function (result) {
                _data = $text.html();
                var htmla = "";
                $.ajax({
                    type: "POST",
                    url: window.local,
                    data: _data,
                    cache: false,
                    success: function (html) {
                        $loading.show().fadeOut(300);

                        var UserList = '@Session["UserName"]';
                        var d = new Date($.now());
                        var ampm = (d.getHours() >= 12) ? "PM" : "AM";
                        var month_names = ["01", "02", "03",
                            "04", "05", "06",
                            "07", "08", "09",
                            "10", "11", "12"]; //var month_names = ["Jan", "Feb", "Mar",
                            //"Apr", "May", "Jun",
                            //"Jul", "Aug", "Sep",
                            //"Oct", "Nov", "Dec"];
                        var month_index = d.getMonth();
                        var date = (d.getDate() + "/" + month_names[month_index] + "/" + d.getFullYear() + " " + d.getHours() + ":" + d.getMinutes() +  ' ' + ampm);
                        //htmla += "<span>" + UserList +"</span> at  "+date+"";
                        //htmla += "<div>" + _data + "</div>";
                        htmla += '<div class="row"><div class="col-sm-6"><label>' + UserList + ' : ' + _data + '</label></div>';
                        htmla += '<div class="col-sm-6"></div><div class="col-sm-6"><label>' + date + '</label></div><div class="col-sm-6"></div></div>';

                        $listComment.append(htmla);
                        $text.html("");
                        $totalCom.text($(".list-comments > div").length);
                    }
                });
                return false;
            }

                });

            }

    });


     var Filedlt = [];
    $("#FileSelectTbl tbody").on('click', '.iconFileDelete', function (e) {
        
        var obj = { "FileId": "", "ClientID": "", "CreatedBy": "" };
        var nRow = $(this).parents('tr')[0];
        var oTable = $('#FileSelectTbl').dataTable();
        var iPos = oTable.fnGetPosition(nRow);
        var aData = oTable.fnGetData(iPos);
        obj.FileId = aData[1];
        obj.ClientID = '@Session["ClientID"]';
        obj.CreatedBy = '@Session["UserId"]';
        Filedlt.push(obj);
        oTable.fnDeleteRow(nRow);
        var obj = { "FileId": "", "ClientID": "", "CreatedBy": "" };
    });

     var clibt = [];
    $("#tbl tbody").on('click', '.iconcliDelete', function (e) {
        
        var obj = { "modulename": "", "formname": "", "productname": "", "issuetype": "", "issuedate": "", "description": "" };
        var nRow = $(this).parents('tr')[0];
        var oTable = $('#tbl').dataTable();
        var iPos = oTable.fnGetPosition(nRow);
        var aData = oTable.fnGetData(iPos);
        obj.modulename = aData[1];
        obj.ClientID = '@Session["ClientID"]';
        obj.CreatedBy = '@Session["UserId"]';
        clibt.push(obj);
        oTable.fnDeleteRow(nRow);
        var obj = { "modulename": "", "formname": "", "productname": "", "issuetype": "", "issuedate": "", "description": "" };
        $("#txtproductname").val(0);
        $("#modulename").val(0);
        $("#formname").val(0);
        $("#IssueType11").val(0);
        $("#IssueType11").val(0);
        $("#description").val("");
        $('#FileSelectTbl').dataTable().fnClearTable();
        $(".count").text("");
    });



    function Btnadd1() {
        if (productname == "" || productname == 0) {
            bootbox.alert({size:"small",message:"Product Name May Not Be Empty"});
            return false;
        }
        else if (modulename == "" || modulename == 0) {
            bootbox.alert({size:"small",message:"Module Name May Not Be Empty"});
            return false;
        }
        else if (formname == "" || formname == 0) {
            bootbox.alert({size:"small",message:"Form Name May Not Be Empty"});
            return false;
        }
        else if (issuetype == "" || issuetype == 0) {
            bootbox.alert({size:"small",message:"Issue Type May Not Be Empty"});
            return false;
        }
        else if (description == "" || description == 0) {
            bootbox.alert({size:"small",message:"Description May Not Be Empty"});
            return false;
        }
        else if (issuedate == "" || issuedate == 0) {
            bootbox.alert({size:"small",message:"Date May Not Be Empty"});
            return false;
        }

        else {
            var dd1 = $("#cdate").val();
            var splitdd1 = dd1.split('/');
            var FRDate = splitdd1[2] + '/' + splitdd1[1] + '/' + splitdd1[0];
            var Approvalflag = 1;
            var clientname = $("#IssueClientName").val()
            var productname = $("#txtproductname option:selected").text();
            var modulename = $("#modulename option:selected").text();
            var formname = $("#formname option:selected").text();
            var issuetype = $("#IssueType11 option:selected").text();
            var issuedate = $("#cdate").val();
            var description = $("#description").val();
            $('.tbl').dataTable().fnAddData([productname,modulename, formname, issuetype, issuedate, description, '<center><i class="fa fa-times-circle icon-cSize iconcliDelete"></i></center>']);
            AddCreate(1);
            //$("#txtproductname").val(0);
            //$("#modulename").val(0);
            //$("#formname").val(0);
            //$("#IssueType11").val(0);
            $("#description").val("");
        }
    }
    //$("#tbl").delegate("tr", "dblclick", function () {
    //    debugger;

    //    var otable = $("#tbl").dataTable();
    //        var position = otable.fnGetPosition(this);
    //        debugger;
    //        if (position != null) {
    //            var values = otable.fnGetData(position);
    //            var pro = values[0];
    //            var modu = values[1];
    //            var form = values[2];
    //            var issu = values[3];
    //            var des = values[5];


    //            $("#txtproductname option:selected").text(pro);
    //            $("#modulename option:selected").text(modu);
    //            $("#formname option:selected").text(form);
    //            $("#IssueType11 option:selected").val(issu);
    //            $("#description").val(des);


    //            otable.fnDeleteRow(position);

    //        }



    //});
    $('#header').css("display", "block");
    function Cancelclk() {
        $.get("../IssueRaise/ADDNEWPARTIALVIEW", { cache: false, headers: { "Accept-Encoding": "gzip" } }, function (n) {

            $("#ADDNEWPARTIALVIEW").html(n);

        });

    }
    function Cancelclk1() {
        $.get("../IssueRaise/ADDNEWPARTIALVIEW", { cache: false, headers: { "Accept-Encoding": "gzip" } }, function (n) {

            $("#ADDNEWPARTIALVIEW").html(n);

        });
        var oTable = $("#FileSelectTbl").dataTable();
        oTable.fnClearTable();

    }
    $("#btnCancel").click(function () {
        debugger
        
        var productname = $("#txtproductname").val();
        if (productname == "" || productname == 0) {
            debugger
            bootbox.alert({ size: "small", message: "Product Name May Not Be Empty" });
            return false;
        }
        else {
            $('#btnCancel').attr("disabled", true);
        bootbox.alert({ size: "small", message: "Saved Successfully" });
            Cancelclk();
        }
    });

    $("#AddClear").click(function () {

        $("#txtproductname").val(0);
        $("#modulename").val(0);
        $("#formname").val(0);
        $("#IssueType11").val(0);
        $("#IssueType11").val(0);
        $("#description").val("");
        $('#FileSelectTbl').dataTable().fnClearTable();

    });


</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.3.0/snap.svg-min.js"></script>